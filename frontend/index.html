<!DOCTYPE html>
<html>
<head>
  <title>Streamly Recommendations</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }

    h1 {
      color: #333;
    }

    .input-area {
      margin-bottom: 20px;
    }

    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 16px;
    }

    .card {
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .card h3 {
      margin-top: 0;
    }

    .tag {
      display: inline-block;
      padding: 3px 8px;
      margin-right: 5px;
      background: #dedede;
      border-radius: 6px;
      font-size: 12px;
    }

    .kids {
      background: #7cc6ff;
    }

    .rating {
      background: #ff9f7c;
    }
  </style>
</head>
<body>

  <h1>Streamly Recommendations</h1>

  <div class="input-area">
    <label>
      Profile ID:
      <input id="profile_id" type="number" />
    </label>
    <button onclick="loadRecs()">Get Recommendations</button>
  </div>

  <div id="cards" class="cards"></div>

  <script>
    async function loadRecs() {
      const id = document.getElementById("profile_id").value;
      const cards = document.getElementById("cards");

      if (!id) {
        cards.innerHTML = "<p>Please enter a Profile ID.</p>";
        return;
      }

      cards.innerHTML = "<p>Loading recommendations...</p>";

      try {
        const resp = await fetch(`http://127.0.0.1:5000/recommendations?profile_id=${id}`);
        if (!resp.ok) throw new Error(`Server returned ${resp.status}`);

        const data = await resp.json();

        if (!Array.isArray(data) || data.length === 0) {
          cards.innerHTML = "<p>No recommendations found.</p>";
          return;
        }

        let html = "";
        data.forEach(item => {
          html += `
            <div class="card">
              <h3>${item.title_name}</h3>

              <p><strong>Category:</strong> ${item.category ?? "Unknown"}</p>
              <p><strong>Year:</strong> ${item.year ?? "N/A"}</p>
              <p><strong>Duration:</strong> ${item.duration} min</p>

              <p>
                <span class="tag">${item.age_rating}</span>
                <span class="tag">Region: ${item.origin_region}</span>
                ${item.is_kids_content ? `<span class="tag kids">Kids</span>` : ""}
                ${item.imdb_rating ? `<span class="tag rating">IMDb: ${item.imdb_rating}</span>` : ""}
              </p>
            </div>
          `;
        });

        cards.innerHTML = html;

      } catch (err) {
        cards.innerHTML = `<p>Error fetching recommendations: ${err.message}</p>`;
      }
    }
  </script>

</body>
</html>
